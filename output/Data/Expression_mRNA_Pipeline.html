<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="vendor/fontawesome/css/all.min.css" rel="stylesheet">
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,600;0,700;1,300;1,400;1,600;1,700&display=swap" rel="stylesheet">
    
      <link rel="stylesheet" href=/home/jacob/Work/Docsite-Revamp/css/styles.css>
    
      <link rel="stylesheet" href=/home/jacob/Work/Docsite-Revamp/css/docs.css>
    
    <!--<link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../../css/encyclopedia.css">-->
</head>
<body>
    <!---->
    <nav class="navbar navbar-expand-md navbar-light bg-light">
        <div class="container-fluid">
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <!-- Collapsed navigation -->
          <div class="my-container">
            <!-- Main title -->
            <a class="navbar-brand float-start" href="/.">
                <img class="brand-image" src="../../img/nih-header-logo-color.png" alt="NIH National Cancer Institute GDC Documentation">
                <span class="hidden">NIH National Cancer Institute GDC Documentation</span>
            </a>
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- GDC Apps -->
            <div class="pull-right">
              <div class="gdc-app-list dropbtn">
                <div class="dropbtn">
                  <a id='myToggle' class="dropbtn dropdown-toggle">
                    <span class="dropbtn"><i class="fas fa-th"></i> GDC Apps</span>
                  </a>
                  <div id="myDropdown" class="dropdown-content container">
                    <div class="row gdc-app-row">
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                    </div>
                    <div class="row gdc-app-row">
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                    </div>
                    <div class="row gdc-app-row">
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                      <div class="col-sm gdc-app-list">
                        <i class="fas fa-lg fa-heartbeat"></i>
                      </div>
                    </div>
                  </div>
                </div>
                <div data-dropdown-menu="" class="dropdown-menu gdc-apps-menu-container" role="menu">
                  <div class="gdc-apps-menu-grid">
                    <div class="menu-column">
                      <a href="https://portal.gdc.cancer.gov/" title="Data Portal" target="_blank" class="menu-item">
                        <img width="21px" src="/img/GDC-App-data-portal-blue.svg" class="icon icon-gdc-portal home" alt="GDC Data Portal">
                        <div>Data Portal</div>
                      </a>
                      <a href="https://gdc.cancer.gov/developers/gdc-application-programming-interface-api" title="GDC API" target="_blank" class="menu-item">
                        <span class="icon icon-gdc-portal-api">
                          <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span>
                          </span>
                        <div>API</div>
                      </a>
                      <a href="https://docs.gdc.cancer.gov/" title="GDC Docs" target="_blank" class="active menu-item">
                        <span class="icon icon-gdc-docs">
                          <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span><span class="path11"></span><span class="path12"></span><span class="path13"></span><span class="path14"></span>
                        </span>
                        <div>Documentation</div>
                      </a>
                      <a href="https://portal.gdc.cancer.gov/legacy-archive" title="GDC Legacy Archive" target="_blank" class="menu-item">
                        <span class="icon icon-gdc-legacy-archive">
                          <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span>
                        </span>
                        <div>Legacy Archive</div>
                      </a>
                    </div>
                    <div class="menu-column">
                      <a href="https://gdc.cancer.gov/" title="GDC Website" target="_blank" class="menu-item">
                        <img width="21px" src="/img/GDC-App-website-blue.svg" class="icon icon-gdc-portal home" alt="GDC Website">
                        <div>Website</div>
                      </a>
                      <a href="https://gdc.cancer.gov/access-data/gdc-data-transfer-tool" class="menu-item" title="GDC Data Transfer Tool" target="_blank">
                        <span class="icon icon-gdc-data-transer-tool">
                          <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span>
                        </span>
                        <div>Data Transfer Tool</div>
                      </a>
                      <a href="https://portal.gdc.cancer.gov/submission/" title="GDC Submission Portal" target="_blank" class="menu-item">
                        <span class="icon icon-gdc-submission-portal">
                          <span class="path1"></span><span class="path2"></span><span class="path3"></span><span class="path4"></span><span class="path5"></span><span class="path6"></span><span class="path7"></span><span class="path8"></span><span class="path9"></span><span class="path10"></span>
                        </span>
                        <div>Data Submission Portal</div>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
              <div class="container-fluid">
              <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav navbar-center me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="#">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" aria-current="page" href="#">API</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Data Submission</a>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    Data Transfer Tool
                    </a>
                    <ul class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                    <li><a class="dropdown-item" href="#">Action</a></li>
                    <li><a class="dropdown-item" href="#">Another action</a></li>
                    <li><a class="dropdown-item" href="#">Something else here</a></li>
                    </ul>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Data Dictionary</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Data</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#">Encyclopedia</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="#"><i class="fas fa-search"></i></a>
                </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </nav>

      <div class="row">
      <div class="col-md-3">
        <div class="container-fluid sidebar-container">
          <div class="sidebar">
            <ul class="main">
              <li class="main"><a href="#">Getting Started</a></li>
              <ul>
                <li><a href='#Introduction'>Introduction</a></li><li><a href='#Data Processing Steps'>Data Processing Steps</a></li><li><a href='#mRNA Expression Transformation'>mRNA Expression Transformation</a></li><li><a href='#Fusion Pipelines'>Fusion Pipelines</a></li><li><a href='#scRNA-Seq Pipeline (single-nuclei)'>scRNA-Seq Pipeline (single-nuclei)</a></li><li><a href='#File Access and Availability'>File Access and Availability</a></li>
              </ul>
              <li class="inactive"><a href="#">Search and Retrieval</a></li>
              <li class="inactive"><a href="#">Data Analysis</a></li>
              <li class="inactive"><a href="#">BAM Slicing</a></li>
              <li class="inactive"><a href="#">Submission</a></li>
              <li class="inactive"><a href="#">Python Examples</a></li>
              <li class="inactive"><a href="#">GraphQL Examples</a></li>
              <li class="inactive"><a href="#">System Information</a></li>
              <li class="inactive"><a href="#">Additional Examples</a></li>
              <li class="inactive"><a href="#">Appendix A: Available Fields</a></li>
              <li class="inactive"><a href="#">Appendix B: Key Terms</a></li>
              <li class="inactive"><a href="#">Appendix C: Format of Submission Queries and Responses</a></li>
              <li class="inactive"><a href="#">Release Notes</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="col-md-9">
        <div class="container-fluid doc-container">
          <h1><i class="fas fa-book"></i>   mRNA Analysis Pipeline</h1><hr>
<h2>Introduction</h2>
<p>The GDC mRNA quantification analysis pipeline measures gene level expression with <a href="https://github.com/alexdobin/STAR/blob/master/doc/STARmanual.pdf">STAR</a> as raw read counts. Subsequently the counts are augmented with several transformations including Fragments per Kilobase of transcript per Million mapped reads (FPKM), upper quartile normalized FPKM (FPKM-UQ), and Transcripts per Million (TPM). These values are additionally annotated with the gene symbol and gene bio-type. These data are generated through this pipeline by first aligning reads to the GRCh38 <a href="https://gdc.cancer.gov/download-gdc-reference-files">reference genome</a> and then by quantifying the mapped reads. To facilitate harmonization across samples, all RNA-Seq reads are treated as unstranded during analyses.</p>
<h2>Data Processing Steps</h2>
<h3>RNA-Seq Alignment Workflow</h3>
<p>The mRNA Analysis pipeline begins with the <a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=alignment_workflow">Alignment Workflow</a>, which is performed using a two-pass method with <a href="https://github.com/alexdobin/STAR/blob/master/doc/STARmanual.pdf">STAR</a>. STAR aligns each <a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=read_group">read group</a> separately and then merges the resulting alignments into one. Following the methods used by the International Cancer Genome Consortium <a href="https://icgc.org/">ICGC</a> (<a href="https://github.com/akahles/icgc_rnaseq_align">github</a>), the two-pass method includes a splice junction detection step, which is used to generate the final alignment. This workflow outputs a genomic BAM file, which contains both aligned and unaligned reads. Quality assessment is performed pre-alignment with <a href="http://www.bioinformatics.babraham.ac.uk/projects/fastqc/">FASTQC</a> and post-alignment with <a href="http://broadinstitute.github.io/picard/">Picard Tools</a>.</p>
<p>Files that were processed after Data Release 14 have associated transcriptomic and chimeric alignments in addition to the genomic alignment detailed above. This only applies to aliquots with at least one set of paired-end reads. The chimeric BAM file contains reads that were mapped to different chromosomes or strands (fusion alignments). The genomic alignment files contain chimeric and unaligned reads to facilitate the retrieval of all original reads. The transcriptomic alignment reports aligned reads with transcript coordinates rather than genomic coordinates. The transcriptomic alignment is also sorted differently to facilitate downstream analyses. BAM index file pairing is not supported by this method of sorting, which does not allow for BAM slicing on these alignments. The splice-junction file for these alignments are also available.</p>
<p>Files that were processed after Data Release 25 will have associated <a href="#fusion-pipelines">gene fusion files</a>.</p>
<p>As of Data Release 32 the reference annotation will be updated to GENCODE v36 and HT-Seq will no longer be used.</p>
<p><a href="images/RNA-Seq-DR32_Image.png" title="Click to see the full image."><img alt="RNA Alignment Pipeline" src="images/RNA-Seq-DR32_Image.png" /></a></p>
<table class='table'>
<thead>
<tr>
<th>I/O</th>
<th>Entity</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input</td>
<td><a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=submitted_unaligned_reads">Submitted Unaligned Reads</a> or <a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=submitted_aligned_reads">Submitted Aligned Reads</a></td>
<td>FASTQ or BAM</td>
</tr>
<tr>
<td>Output</td>
<td><a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=aligned_reads">Aligned Reads</a></td>
<td>BAM</td>
</tr>
</tbody>
</table>
<h3>RNA-Seq Alignment Command Line Parameters</h3>
<p><strong>Note that version numbers may vary in files downloaded from the GDC Data Portal due to ongoing pipeline development and improvement.</strong></p>
<pre><code class="language-Original"># STAR-2

### For users with access to the ICGC pipeline:

python star_align.py \
--genomeDir &lt;star_index_path&gt; \
--FastqFileIn &lt;input_fastq_path&gt; \
--workDir &lt;work_dir&gt; \
--out &lt;output_bam&gt; \
--genomeFastaFiles &lt;reference&gt; \
--runThreadN 8 \
--outFilterMultimapScoreRange 1 \
--outFilterMultimapNmax 20 \
--outFilterMismatchNmax 10 \
--alignIntronMax 500000 \
--alignMatesGapMax 1000000 \
--sjdbScore 2 \
--limitBAMsortRAM 0 \
--alignSJDBoverhangMin 1 \
--genomeLoad NoSharedMemory \
--outFilterMatchNminOverLread 0.33 \
--outFilterScoreMinOverLread 0.33 \
--twopass1readsN -1 \
--sjdbOverhang 100 \
--outSAMstrandField intronMotif \
--outSAMunmapped Within

### For users without access to the ICGC pipeline:

### Step 1: Building the STAR index.*

STAR
--runMode genomeGenerate
--genomeDir &lt;star_index_path&gt;
--genomeFastaFiles &lt;reference&gt;
--sjdbOverhang 100
--sjdbGTFfile &lt;gencode.v36.annotation.gtf&gt;
--runThreadN 8

### Step 2: Alignment 1st Pass.

STAR
--genomeDir &lt;star_index_path&gt;
--readFilesIn &lt;fastq_left_1&gt;,&lt;fastq_left2&gt;,... &lt;fastq_right_1&gt;,&lt;fastq_right_2&gt;,...
--runThreadN &lt;runThreadN&gt;
--outFilterMultimapScoreRange 1
--outFilterMultimapNmax 20
--outFilterMismatchNmax 10
--alignIntronMax 500000
--alignMatesGapMax 1000000
--sjdbScore 2
--alignSJDBoverhangMin 1
--genomeLoad NoSharedMemory
--readFilesCommand &lt;bzcat|cat|zcat&gt;
--outFilterMatchNminOverLread 0.33
--outFilterScoreMinOverLread 0.33
--sjdbOverhang 100
--outSAMstrandField intronMotif
--outSAMtype None
--outSAMmode None

### Step 3: Intermediate Index Generation.

STAR
--runMode genomeGenerate
--genomeDir &lt;output_path&gt;
--genomeFastaFiles &lt;reference&gt;
--sjdbOverhang 100
--runThreadN &lt;runThreadN&gt;
--sjdbFileChrStartEnd &lt;SJ.out.tab from previous step&gt;

### Step 4: Alignment 2nd Pass.

STAR
--genomeDir &lt;output_path from previous step&gt;
--readFilesIn &lt;fastq_left_1&gt;,&lt;fastq_left2&gt;,... &lt;fastq_right_1&gt;,&lt;fastq_right_2&gt;,...
--runThreadN &lt;runThreadN&gt;
--outFilterMultimapScoreRange 1
--outFilterMultimapNmax 20
--outFilterMismatchNmax 10
--alignIntronMax 500000
--alignMatesGapMax 1000000
--sjdbScore 2
--alignSJDBoverhangMin 1
--genomeLoad NoSharedMemory
--limitBAMsortRAM 0
--readFilesCommand &lt;bzcat|cat|zcat&gt;
--outFilterMatchNminOverLread 0.33
--outFilterScoreMinOverLread 0.33
--sjdbOverhang 100
--outSAMstrandField intronMotif
--outSAMattributes NH HI NM MD AS XS
--outSAMunmapped Within
--outSAMtype BAM SortedByCoordinate
--outSAMheaderHD @HD VN:1.4
--outSAMattrRGline &lt;formatted RG line provided by wrapper&gt;
</code></pre>
<pre><code class="language-DR15Plus"># STAR-2

STAR \
--readFilesIn &lt;fastq_files&gt; \
--outSAMattrRGline &lt;read_group_strings&gt; \
--alignIntronMax 1000000 \
--alignIntronMin 20 \
--alignMatesGapMax 1000000 \
--alignSJDBoverhangMin 1 \
--alignSJoverhangMin 8 \
--alignSoftClipAtReferenceEnds Yes \
--chimJunctionOverhangMin 15 \
--chimMainSegmentMultNmax 1 \
--chimOutType Junctions SeparateSAMold WithinBAM SoftClip \
--chimSegmentMin 15 \
--genomeDir &lt;genome_dir&gt; \
--genomeLoad NoSharedMemory \
--limitSjdbInsertNsj 1200000 \
--outFileNamePrefix &lt;output_prefix&gt; \
--outFilterIntronMotifs None \
--outFilterMatchNminOverLread 0.33 \
--outFilterMismatchNmax 999 \
--outFilterMismatchNoverLmax 0.1 \
--outFilterMultimapNmax 20 \
--outFilterScoreMinOverLread 0.33 \
--outFilterType BySJout \
--outSAMattributes NH HI AS nM NM ch \
--outSAMstrandField intronMotif \
--outSAMtype BAM Unsorted \
--outSAMunmapped Within \
--quantMode TranscriptomeSAM GeneCounts \
--readFilesCommand &lt;zcat, etc&gt; \
--runThreadN &lt;threads&gt; \
--twopassMode Basic
</code></pre>
<pre><code class="language-DR32"># STAR Genome Index
STAR
--runMode genomeGenerate
--genomeDir &lt;star_index_path&gt;
--genomeFastaFiles &lt;reference&gt;
--sjdbOverhang 100
--sjdbGTFfile &lt;gencode.v36.annotation.gtf&gt;
--runThreadN 8

# STAR Alignment
# STAR v2
STAR
--readFilesIn &lt;fastq_files&gt; \
--outSAMattrRGline &lt;read_group_strings&gt; \
--genomeDir &lt;genome_dir&gt; \
--readFilesCommand &lt;cat, zcat, etc&gt; \
--runThreadN &lt;threads&gt; \
--twopassMode Basic \
--outFilterMultimapNmax 20 \
--alignSJoverhangMin 8 \
--alignSJDBoverhangMin 1 \
--outFilterMismatchNmax 999 \
--outFilterMismatchNoverLmax 0.1 \
--alignIntronMin 20 \
--alignIntronMax 1000000 \
--alignMatesGapMax 1000000 \
--outFilterType BySJout \
--outFilterScoreMinOverLread 0.33 \
--outFilterMatchNminOverLread 0.33 \
--limitSjdbInsertNsj 1200000 \
--outFileNamePrefix &lt;output prefix&gt; \
--outSAMstrandField intronMotif \
--outFilterIntronMotifs None \
--alignSoftClipAtReferenceEnds Yes \
--quantMode TranscriptomeSAM GeneCounts \
--outSAMtype BAM Unsorted \
--outSAMunmapped Within \
--genomeLoad NoSharedMemory \
--chimSegmentMin 15 \
--chimJunctionOverhangMin 15 \
--chimOutType Junctions SeparateSAMold WithinBAM SoftClip \
--chimOutJunctionFormat 1 \
--chimMainSegmentMultNmax 1 \
--outSAMattributes NH HI AS nM NM ch
</code></pre>
<p>*These indices are available for download at the <a href="https://gdc.cancer.gov/about-data/data-harmonization-and-generation/gdc-reference-files">GDC Website</a> and do not need to be built again.</p>
<h3>mRNA Expression Workflow</h3>
<p>The primary counting data is generated by STAR and includes a gene ID, unstranded, and stranded counts data. Following alignment, the raw counts files produced by STAR are augmented with commonly used counts transformations (FPKM, FPKM-UQ, and TPM) along with basic annotations as part of the <a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=rna_expression_workflow">RNA Expression Workflow</a>. These data are provided in a tab-delimited format. <a href="https://www.gencodegenes.org/human/release_36.html">GENCODE v36</a> was used for gene annotation.</p>
<p>Note that the STAR counting results will not count reads that are mapped to more than one different gene. Below are two files that list genes that are completely encompassed by other genes and will likely display a value of zero.</p>
<ul>
<li><a href="/Data/Bioinformatics_Pipelines/overlap.gene.stranded.tsv">Overlapped Genes (stranded)</a></li>
<li><a href="/Data/Bioinformatics_Pipelines/overlap.gene.strandless.tsv">Overlapped Genes (unstranded)</a></li>
</ul>
<table class='table'>
<thead>
<tr>
<th>I/O</th>
<th>Entity</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>Input</td>
<td><a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=aligned_reads">Aligned Reads</a></td>
<td>BAM</td>
</tr>
<tr>
<td>Output</td>
<td><a href="/Data_Dictionary/viewer/#?view=table-definition-view&amp;id=gene_expression">Gene Expression</a></td>
<td>TXT</td>
</tr>
</tbody>
</table>
<h3>mRNA Quantification Command Line Parameters</h3>
<p>HTSeq</p>
<pre><code class="language-Current">Counts are produced by STAR concurrent with alignment.
</code></pre>
<pre><code class="language-Original">htseq-count \
-m intersection-nonempty \
-i gene_id \
-r pos \
-s no \
- gencode.v22.annotation.gtf
</code></pre>
<pre><code class="language-DR15-31">htseq-count \
-f bam \
-r name \
-s no \
-a 10 \
-t exon \
-i gene_id \
-m intersection-nonempty \
&lt;input_bam&gt; \
&lt;gtf_file&gt; &gt; &lt;counts_file&gt;
</code></pre>
<h2>mRNA Expression Transformation</h2>
<p>RNA-Seq expression level read counts produced by the workflow are normalized using three commonly used methods: FPKM, FPKM-UQ, and TPM. Normalized values should be used only within the context of the entire gene set. Users are encouraged to normalize raw read count values if a subset of genes is investigated.</p>
<h3>FPKM</h3>
<p>The fragments per kilobase of transcript per million mapped reads (FPKM) calculation aims to control for transcript length and overall sequencing quantity.</p>
<h3>Upper Quartile FPKM</h3>
<p>The upper quartile FPKM (FPKM-UQ) is a modified FPKM calculation in which the protein coding gene in the 75th percentile position is substituted for the sequencing quantity. This is thought to provide a more stable value than including the noisier genes at the extremes.</p>
<h3>TPM</h3>
<p>The transcripts per million calculation is similar to FPKM, but the difference is that all transcripts are normalized for length first. Then, instead of using the total overall read count as a normalization for size, the sum of the length-normalized transcript values are used as an indicator of size.</p>
<h3>Calculations</h3>
<p><a href="images/normalizations_calc.png" title="Click to see the full image."><img alt="FPKM Calculations" src="images/normalizations_calc.png" /></a></p>
<p><strong>Note:</strong> The read count is multiplied by a scalar (10<sup>9</sup>) during normalization to account for the kilobase and 'million mapped reads' units.</p>
<h3>Examples</h3>
<p><strong>Sample 1: Gene A</strong></p>
<ul>
<li>Gene length: 3,000 bp</li>
<li>1,000 reads mapped to Gene A</li>
<li>1,000,000 reads mapped to all protein-coding regions</li>
<li>Read count in Sample 1 for 75th percentile gene: 2,000</li>
<li>Number of protein coding genes on autosomes: 19,029</li>
<li>Sum of length-normalized transcript counts: 9,000,000</li>
</ul>
<p><strong>FPKM for Gene A</strong> = 1,000 * 10^9 / (3,000 * 50,000,000) = <strong>6.67</strong></p>
<p><strong>FPKM-UQ for Gene A</strong> = 1,000) * 10^9 / (3,000 * 2,000 * 19,029) = <strong>8.76</strong></p>
<p><strong>TPM for Gene A</strong> = (1,000 * 1,000 / 3,000) * 1,000,000 / (9,000,000) = <strong>37.04</strong></p>
<h2>Fusion Pipelines</h2>
<p>The GDC uses two pipelines for the detection of gene fusions.</p>
<h3>STAR-Fusion Pipeline</h3>
<p>The GDC gene fusion pipeline uses the STAR-Fusion v1.6 algorithm to generate gene fusion data.
STAR-Fusion pipeline processes the output generated by STAR aligner to map junction reads
and spanning reads to a junction annotation set. It utilizes a chimeric junction file from
running the STAR aligner and produces a tab-limited gene fusion prediction file.
The prediction file provides fused gene names, junction read count and breakpoint information.</p>
<h3>Arriba Fusion Pipeline</h3>
<p>The <a href="https://github.com/suhrig/arriba">Arriba gene fusion pipeline</a> uses Arriba v1.1.0 to detect gene fusions from the RNA-Seq data of tumor samples.</p>
<h2>scRNA-Seq Pipeline (single-nuclei)</h2>
<p>The GDC processes single-cell RNA-Seq (scRNA-Seq) data using the <a href="https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/latest/what-is-cell-ranger">Cell Ranger pipeline</a> to calculate gene expression followed by <a href="https://satijalab.org/seurat/">Seurat</a> for secondary expression analysis.</p>
<h3>scRNA Gene Expression Pipeline</h3>
<p>The gene expression pipeline, which uses Cell Ranger, generates three files:</p>
<ul>
<li>Aligned reads file (BAM)</li>
<li>Raw counts matrix - contains all barcodes in <a href="https://math.nist.gov/MatrixMarket/formats.html">Market Exchange Format</a> (MEX)</li>
<li>Filtered counts matrix - contains only detected cellular barcodes  (MEX)</li>
</ul>
<h3>scRNA Analysis Pipeline</h3>
<p>The analysis pipeline, which uses the Seurat software, generates three files from an input of Filtered counts matrix:</p>
<ul>
<li>Analysis - PCA, UMAP, tSNE values, and graph-based clustering results with associated metadata (TSV).</li>
<li>Differential gene expression - DEG information comparing cells from one cluster to the rest of the cells (TSV).</li>
<li>Full Seurat analysis log as a loom object in <a href="https://portal.hdfgroup.org/display/knowledge/HDF+Knowledge+Base">HDF5</a> format.</li>
</ul>
<p>When the input RNA was extracted from nuclei instead of cytoplasm, a slightly modified quantification method is implemented to include introns. Currently, these single-nuclei RNA-Seq (snRNA-Seq) analyses share the same experimental strategy (scRNA-Seq) in the Data Portal, and can be filtered by querying for aliquot.analyte_type = "Nuclei RNA".</p>
<h2>File Access and Availability</h2>
<p>To facilitate the use of harmonized data in user-created pipelines, RNA-Seq gene expression is accessible in the GDC Data Portal at several intermediate steps in the pipeline. Below is a description of each type of file available for download in the GDC Data Portal.</p>
<table class='table'>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Format</th>
</tr>
</thead>
<tbody>
<tr>
<td>RNA-Seq Alignment</td>
<td>RNA-Seq reads that have been aligned to the GRCh38 build. Reads that were not aligned are included to facilitate the availability of raw read sets.</td>
<td>BAM</td>
</tr>
<tr>
<td>STAR Read Counts</td>
<td>The number of reads aligned to each gene, calculated by STAR, along with values using common normalization methods.</td>
<td>TSV</td>
</tr>
</tbody>
</table>
        </div>
      </div>
    </div>

      <footer id="docs-footer">
        <div class="container-fluid footer-container">

      <div>
        <a href="https://portal.gdc.cancer.gov" target="_blank">Site Home</a>
        | <a href="http://www.cancer.gov/global/web/policies" target="_blank">Policies</a>
        | <a href="http://www.cancer.gov/global/web/policies/accessibility" target="_blank">Accessibility</a>
        | <a href="http://www.cancer.gov/global/web/policies/foia" target="_blank">FOIA</a>
      </div>
      <div>
        <a href="http://www.hhs.gov" target="_blank">U.S. Department of Health and Human Services</a>
        | <a href="http://www.nih.gov" target="_blank">National Institutes of Health</a>
        | <a href="http://www.cancer.gov" target="_blank">National Cancer Institute</a>
        | <a href="http://www.usa.gov" target="_blank">USA.gov</a>
      </div>
      <div>
        NIH... Turning Discovery Into Health Â®
      </div>

      <div class="version-caption">
        GDC Docs Version 2.0
      </div>
    </div>
    </footer>
    



    
<script>
/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */

// Close the dropdown if the user clicks outside of it

var toggler = document.getElementById("myToggle");
toggler.onclick= function(){
    var myDropdown = document.getElementById("myDropdown");
    myDropdown.classList.toggle('show');
}
window.onclick = function(e) {
    if (!e.target.matches('.dropbtn')) {
        var myDropdown = document.getElementById("myDropdown");
    if (myDropdown.classList.contains('show')) {
        myDropdown.classList.remove('show');
    }
  }
}

</script>

    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>      
</body>
</html>